#include "hw.h"
int global_debug = 0;

/** Constants */
static const real km_grid[NKM_GRID] = {
	30.000000000000000,
	36.666667938232422,
	43.333332061767578,
	50.000000000000000
};

static const real k_grid[NKGRID] = {
	0.000000000000000,
	0.000000000010729,
	0.000000001373294,
	0.000000023464024,
	0.000000175781665,
	0.000000838192193,
	0.000003003395022,
	0.000008835676454,
	0.000022500053092,
	0.000051315822930,
	0.000107288600702,
	0.000209075165913,
	0.000384434562875,
	0.000673220085446,
	0.001130966586061,
	0.001833126880229,
	0.002880006795749,
	0.004402466118336,
	0.006568425334990,
	0.009590226225555,
	0.013732940889895,
	0.019323633983731,
	0.026761621236801,
	0.036529898643494,
	0.049207624047995,
	0.065483748912811,
	0.086172170937061,
	0.112227700650692,
	0.144763723015785,
	0.185071527957916,
	0.234640240669250,
	0.295178949832916,
	0.368640869855881,
	0.457247465848923,
	0.563515663146973,
	0.690287411212921,
	0.840758442878723,
	1.018510818481445,
	1.227548956871033,
	1.472332715988159,
	1.757816433906555,
	2.089491844177246,
	2.473425149917603,
	2.916303873062134,
	3.425487518310547,
	4.009048461914062,
	4.675827026367188,
	5.435489654541016,
	6.298575878143311,
	7.276560783386230,
	8.381919860839844,
	9.628192901611328,
	11.030037879943848,
	12.603313446044922,
	14.365145683288574,
	16.334003448486328,
	18.529756546020508,
	20.973821640014648,
	23.689155578613281,
	26.700399398803711,
	30.033950805664062,
	33.718063354492188,
	37.782905578613281,
	42.260772705078125,
	47.186031341552734,
	52.595329284667969,
	58.527675628662109,
	65.024520874023438,
	72.130004882812500,
	79.890884399414062,
	88.356788635253906,
	97.580299377441406,
	107.617080688476562,
	118.525978088378906,
	130.369384765625000,
	143.212997436523438,
	157.126266479492188,
	172.182403564453125,
	188.458587646484375,
	206.036026000976562,
	225.000503540039062,
	245.441925048828125,
	267.454956054687500,
	291.138977050781250,
	316.598419189453125,
	343.942626953125000,
	373.286895751953125,
	404.751434326171875,
	438.462402343750000,
	474.551910400390625,
	513.158203125000000,
	554.425659179687500,
	598.505859375000000,
	645.556518554687500,
	695.742675781250000,
	749.236511230468750,
	806.217712402343750,
	866.873474121093750,
	931.399780273437500,
	1000.000000000000000
};

static const real init_kp[NSTATES] = {
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000,
	0.000000000000000,
	0.000000000009656,
	0.000000001235965,
	0.000000021117621,
	0.000000158203505,
	0.000000754372991,
	0.000002703055543,
	0.000007952108717,
	0.000020250048692,
	0.000046184239181,
	0.000096559742815,
	0.000188167643500,
	0.000345991109498,
	0.000605898094364,
	0.001017869915813,
	0.001649814192206,
	0.002592006232589,
	0.003962219692767,
	0.005911582615227,
	0.008631203323603,
	0.012359647080302,
	0.017391270026565,
	0.024085458368063,
	0.032876908779144,
	0.044286862015724,
	0.058935374021530,
	0.077554956078529,
	0.101004928350449,
	0.130287349224091,
	0.166564375162125,
	0.211176216602325,
	0.265661060810089,
	0.331776797771454,
	0.411522716283798,
	0.507164120674133,
	0.621258676052094,
	0.756682574748993,
	0.916659712791443,
	1.104794025421143,
	1.325099468231201,
	1.582034826278687,
	1.880542635917664,
	2.226082563400269,
	2.624673366546631,
	3.082938671112061,
	3.608143568038940,
	4.208244323730469,
	4.891940593719482,
	5.668718338012695,
	6.548904895782471,
	7.543727874755859,
	8.665373802185059,
	9.927034378051758,
	11.342982292175293,
	12.928630828857422,
	14.700603485107422,
	16.676780700683594,
	18.876440048217773,
	21.320240020751953,
	24.030359268188477,
	27.030555725097656,
	30.346256256103516,
	34.004615783691406,
	38.034694671630859,
	42.467430114746094,
	47.335796356201172,
	52.674907684326172,
	58.522068023681641,
	64.917007446289062,
	71.901794433593750,
	79.521110534667969,
	87.822265625000000,
	96.855369567871094,
	106.673377990722656,
	117.332443237304688,
	128.891693115234375,
	141.413635253906250,
	154.964157104492188,
	169.612731933593750,
	185.432418823242188,
	202.500457763671875,
	220.897735595703125,
	240.709457397460938,
	262.025085449218750,
	284.938568115234375,
	309.548370361328125,
	335.958190917968750,
	364.276306152343750,
	394.616149902343750,
	427.096710205078125,
	461.842376708984375,
	498.983093261718750,
	538.655273437500000,
	581.000854492187500,
	626.168395996093750,
	674.312866210937500,
	725.595947265625000,
	780.186157226562500,
	838.259826660156250,
	900.000000000000000
};

const real init_wealth[NSTATES] = {
	0.323347926139832,
	0.323347926139832,
	0.323347926139832,
	0.323347955942154,
	0.323348104953766,
	0.323348790407181,
	0.323350965976715,
	0.323356896638870,
	0.323370784521103,
	0.323400020599365,
	0.323456883430481,
	0.323560237884521,
	0.323738276958466,
	0.324031531810760,
	0.324496328830719,
	0.325209319591522,
	0.326272338628769,
	0.327818274497986,
	0.330017626285553,
	0.333086013793945,
	0.337292611598969,
	0.342969506978989,
	0.350522160530090,
	0.360441058874130,
	0.373314261436462,
	0.389841347932816,
	0.410848736763000,
	0.437306016683578,
	0.470343679189682,
	0.511272966861725,
	0.561605989933014,
	0.623078107833862,
	0.697672665119171,
	0.787645459175110,
	0.895552158355713,
	1.024278521537781,
	1.177069544792175,
	1.357562661170959,
	1.569823861122131,
	1.818381786346436,
	2.108267307281494,
	2.445056676864624,
	2.834909677505493,
	3.284616708755493,
	3.801651239395142,
	4.394209861755371,
	5.071269035339355,
	5.842644691467285,
	6.719038486480713,
	7.712102413177490,
	8.834504127502441,
	10.099992752075195,
	11.523452758789062,
	13.120985031127930,
	14.909982681274414,
	16.909196853637695,
	19.138805389404297,
	21.620553970336914,
	24.377754211425781,
	27.435426712036133,
	30.820377349853516,
	34.561294555664062,
	38.688808441162109,
	43.235717773437500,
	48.236915588378906,
	53.729618072509766,
	59.753433227539062,
	66.350448608398438,
	73.565490722656250,
	81.446029663085938,
	90.042465209960938,
	99.408187866210938,
	109.599723815917969,
	120.676818847656250,
	132.702835083007812,
	145.744476318359375,
	159.872268676757812,
	175.160537719726562,
	191.687683105468750,
	209.536132812500000,
	228.793014526367188,
	249.549621582031250,
	271.902069091796875,
	295.951263427734375,
	321.803253173828125,
	349.569061279296875,
	379.365753173828125,
	411.315429687500000,
	445.546173095703125,
	482.192138671875000,
	521.393676757812500,
	563.297424316406250,
	608.057250976562500,
	655.833374023437500,
	706.793334960937500,
	761.111938476562500,
	818.971740722656250,
	880.562683105468750,
	946.083923339843750,
	1015.741821289062500,
	2.359242200851440,
	2.359242200851440,
	2.359242200851440,
	2.359242200851440,
	2.359242439270020,
	2.359243154525757,
	2.359245300292969,
	2.359251260757446,
	2.359265089035034,
	2.359294414520264,
	2.359351158142090,
	2.359454631805420,
	2.359632730484009,
	2.359925985336304,
	2.360390663146973,
	2.361103773117065,
	2.362166643142700,
	2.363712549209595,
	2.365911960601807,
	2.368980407714844,
	2.373187065124512,
	2.378863811492920,
	2.386416435241699,
	2.396335363388062,
	2.409208536148071,
	2.425735712051392,
	2.446743011474609,
	2.473200321197510,
	2.506237983703613,
	2.547167301177979,
	2.597500324249268,
	2.658972501754761,
	2.733566999435425,
	2.823539733886719,
	2.931446552276611,
	3.060172796249390,
	3.212964057922363,
	3.393456935882568,
	3.605718135833740,
	3.854276180267334,
	4.144161701202393,
	4.480950832366943,
	4.870803833007812,
	5.320511341094971,
	5.837545871734619,
	6.430104255676270,
	7.107163429260254,
	7.878539085388184,
	8.754932403564453,
	9.747996330261230,
	10.870398521423340,
	12.135887145996094,
	13.559347152709961,
	15.156879425048828,
	16.945877075195312,
	18.945091247558594,
	21.174699783325195,
	23.656448364257812,
	26.413648605346680,
	29.471321105957031,
	32.856269836425781,
	36.597187042236328,
	40.724704742431641,
	45.271614074707031,
	50.272811889648438,
	55.765510559082031,
	61.789325714111328,
	68.386344909667969,
	75.601387023925781,
	83.481925964355469,
	92.078361511230469,
	101.444084167480469,
	111.635620117187500,
	122.712715148925781,
	134.738723754882812,
	147.780364990234375,
	161.908157348632812,
	177.196441650390625,
	193.723571777343750,
	211.572036743164062,
	230.828918457031250,
	251.585510253906250,
	273.937957763671875,
	297.987152099609375,
	323.839141845703125,
	351.604949951171875,
	381.401672363281250,
	413.351348876953125,
	447.582061767578125,
	484.228027343750000,
	523.429565429687500,
	565.333312988281250,
	610.093139648437500,
	657.869262695312500,
	708.829223632812500,
	763.147827148437500,
	821.007629394531250,
	882.598571777343750,
	948.119812011718750,
	1017.777709960937500,
	0.347571521997452,
	0.347571521997452,
	0.347571521997452,
	0.347571551799774,
	0.347571700811386,
	0.347572386264801,
	0.347574561834335,
	0.347580462694168,
	0.347594261169434,
	0.347623378038406,
	0.347679942846298,
	0.347782820463181,
	0.347960025072098,
	0.348251849412918,
	0.348714411258698,
	0.349424004554749,
	0.350481897592545,
	0.352020442485809,
	0.354209244251251,
	0.357262909412384,
	0.361449301242828,
	0.367098957300186,
	0.374615401029587,
	0.384486705064774,
	0.397298157215118,
	0.413745939731598,
	0.434652566909790,
	0.460982918739319,
	0.493862092494965,
	0.534595012664795,
	0.584686517715454,
	0.645863771438599,
	0.720100462436676,
	0.809641599655151,
	0.917030632495880,
	1.045139431953430,
	1.197197556495667,
	1.376824617385864,
	1.588067531585693,
	1.835433125495911,
	2.123927831649780,
	2.459101438522339,
	2.847084045410156,
	3.294633865356445,
	3.809187889099121,
	4.398903846740723,
	5.072714805603027,
	5.840389728546143,
	6.712579250335693,
	7.700878620147705,
	8.817895889282227,
	10.077313423156738,
	11.493944168090820,
	13.083813667297363,
	14.864227294921875,
	16.853851318359375,
	19.072763442993164,
	21.542606353759766,
	24.286579132080078,
	27.329582214355469,
	30.698293685913086,
	34.421260833740234,
	38.528976440429688,
	43.054073333740234,
	48.031276702880859,
	53.497627258300781,
	59.492542266845703,
	66.057914733886719,
	73.238334655761719,
	81.081069946289062,
	89.636268615722656,
	98.957061767578125,
	109.099700927734375,
	120.123657226562500,
	132.091979980468750,
	145.071044921875000,
	159.131057739257812,
	174.345993041992188,
	190.793853759765625,
	208.556671142578125,
	227.721176147460938,
	248.378189086914062,
	270.623413085937500,
	294.557220458984375,
	320.285186767578125,
	347.917785644531250,
	377.571563720703125,
	409.367950439453125,
	443.434478759765625,
	479.904632568359375,
	518.918090820312500,
	560.620788574218750,
	605.165954589843750,
	652.712829589843750,
	703.428283691406250,
	757.486328125000000,
	815.068542480468750,
	876.364013671875000,
	941.570922851562500,
	1010.894653320312500,
	2.535984992980957,
	2.535984992980957,
	2.535984992980957,
	2.535984992980957,
	2.535984992980957,
	2.535985708236694,
	2.535987854003906,
	2.535993814468384,
	2.536007642745972,
	2.536036729812622,
	2.536093235015869,
	2.536196231842041,
	2.536373376846313,
	2.536665201187134,
	2.537127733230591,
	2.537837266921997,
	2.538895368576050,
	2.540433883666992,
	2.542622566223145,
	2.545676231384277,
	2.549862623214722,
	2.555512428283691,
	2.563028812408447,
	2.572900056838989,
	2.585711479187012,
	2.602159261703491,
	2.623065948486328,
	2.649396181106567,
	2.682275533676147,
	2.723008394241333,
	2.773099899291992,
	2.834277153015137,
	2.908513784408569,
	2.998054981231689,
	3.105443954467773,
	3.233552694320679,
	3.385610818862915,
	3.565237998962402,
	3.776480913162231,
	4.023846626281738,
	4.312341213226318,
	4.647514820098877,
	5.035497665405273,
	5.483047485351562,
	5.997601509094238,
	6.587316989898682,
	7.261128425598145,
	8.028802871704102,
	8.900992393493652,
	9.889291763305664,
	11.006309509277344,
	12.265727043151855,
	13.682357788085938,
	15.272226333618164,
	17.052640914916992,
	19.042264938354492,
	21.261177062988281,
	23.731019973754883,
	26.474992752075195,
	29.517995834350586,
	32.886707305908203,
	36.609676361083984,
	40.717391967773438,
	45.242485046386719,
	50.219692230224609,
	55.686042785644531,
	61.680957794189453,
	68.246322631835938,
	75.426750183105469,
	83.269485473632812,
	91.824684143066406,
	101.145469665527344,
	111.288108825683594,
	122.312065124511719,
	134.280380249023438,
	147.259460449218750,
	161.319473266601562,
	176.534408569335938,
	192.982269287109375,
	210.745086669921875,
	229.909591674804688,
	250.566604614257812,
	272.811798095703125,
	296.745635986328125,
	322.473602294921875,
	350.106201171875000,
	379.759979248046875,
	411.556365966796875,
	445.622894287109375,
	482.093048095703125,
	521.106506347656250,
	562.809204101562500,
	607.354309082031250,
	654.901245117187500,
	705.616699218750000,
	759.674743652343750,
	817.256958007812500,
	878.552429199218750,
	943.759338378906250,
	1013.083068847656250,
	0.369115591049194,
	0.369115591049194,
	0.369115620851517,
	0.369115620851517,
	0.369115769863129,
	0.369116455316544,
	0.369118630886078,
	0.369124501943588,
	0.369138270616531,
	0.369167268276215,
	0.369223624467850,
	0.369326144456863,
	0.369502723217010,
	0.369793504476547,
	0.370254427194595,
	0.370961457490921,
	0.372015595436096,
	0.373548626899719,
	0.375729620456696,
	0.378772407770157,
	0.382943898439407,
	0.388573408126831,
	0.396063029766083,
	0.405899107456207,
	0.418664872646332,
	0.435053974390030,
	0.455886036157608,
	0.482122480869293,
	0.514884352684021,
	0.555472016334534,
	0.605384886264801,
	0.666343867778778,
	0.740315854549408,
	0.829537630081177,
	0.936543583869934,
	1.064195513725281,
	1.215711236000061,
	1.394697666168213,
	1.605187058448792,
	1.851670265197754,
	2.139136075973511,
	2.473114252090454,
	2.859713077545166,
	3.305666446685791,
	3.818385362625122,
	4.405997753143311,
	5.077405452728271,
	5.842342376708984,
	6.711420536041260,
	7.696195125579834,
	8.809228897094727,
	10.064154624938965,
	11.475731849670410,
	13.059929847717285,
	14.833993911743164,
	16.816520690917969,
	19.027519226074219,
	21.488552093505859,
	24.222738265991211,
	27.254888534545898,
	30.611583709716797,
	34.321273803710938,
	38.414337158203125,
	42.923290252685547,
	47.882743835449219,
	53.329597473144531,
	59.303131103515625,
	65.845085144042969,
	72.999900817871094,
	80.814659118652344,
	89.339340209960938,
	98.626884460449219,
	108.733352661132812,
	119.717987060546875,
	131.643615722656250,
	144.576400756835938,
	158.586257934570312,
	173.746932983398438,
	190.136108398437500,
	207.835586547851562,
	226.931732177734375,
	247.515075683593750,
	269.680938720703125,
	293.529388427734375,
	319.165588378906250,
	346.699645996093750,
	376.247619628906250,
	407.930603027343750,
	441.875640869140625,
	478.215698242187500,
	517.090026855468750,
	558.643981933593750,
	603.030212402343750,
	650.407531738281250,
	700.942138671875000,
	754.807373046875000,
	812.184143066406250,
	873.261047363281250,
	938.235351562500000,
	1007.311828613281250,
	2.693176746368408,
	2.693176746368408,
	2.693176746368408,
	2.693176746368408,
	2.693176984786987,
	2.693177700042725,
	2.693179845809937,
	2.693185806274414,
	2.693199396133423,
	2.693228483200073,
	2.693284988403320,
	2.693387269973755,
	2.693563938140869,
	2.693854808807373,
	2.694315671920776,
	2.695022583007812,
	2.696076869964600,
	2.697609901428223,
	2.699790954589844,
	2.702833652496338,
	2.707005023956299,
	2.712634563446045,
	2.720124244689941,
	2.729960441589355,
	2.742726087570190,
	2.759115219116211,
	2.779947280883789,
	2.806183815002441,
	2.838945627212524,
	2.879533290863037,
	2.929446220397949,
	2.990405082702637,
	3.064377069473267,
	3.153598785400391,
	3.260604858398438,
	3.388256788253784,
	3.539772510528564,
	3.718758821487427,
	3.929248332977295,
	4.175731658935547,
	4.463197231292725,
	4.797175407409668,
	5.183773994445801,
	5.629727840423584,
	6.142446517944336,
	6.730059146881104,
	7.401466846466064,
	8.166403770446777,
	9.035481452941895,
	10.020256996154785,
	11.133290290832520,
	12.388215065002441,
	13.799793243408203,
	15.383991241455078,
	17.158056259155273,
	19.140583038330078,
	21.351579666137695,
	23.812612533569336,
	26.546798706054688,
	29.578948974609375,
	32.935646057128906,
	36.645336151123047,
	40.738399505615234,
	45.247352600097656,
	50.206806182861328,
	55.653659820556641,
	61.627193450927734,
	68.169143676757812,
	75.323959350585938,
	83.138717651367188,
	91.663398742675781,
	100.950950622558594,
	111.057411193847656,
	122.042045593261719,
	133.967681884765625,
	146.900451660156250,
	160.910324096679688,
	176.070983886718750,
	192.460174560546875,
	210.159652709960938,
	229.255798339843750,
	249.839126586914062,
	272.005004882812500,
	295.853454589843750,
	321.489654541015625,
	349.023681640625000,
	378.571685791015625,
	410.254669189453125,
	444.199676513671875,
	480.539764404296875,
	519.414062500000000,
	560.968017578125000,
	605.354309082031250,
	652.731628417968750,
	703.266174316406250,
	757.131408691406250,
	814.508239746093750,
	875.585083007812500,
	940.559387207031250,
	1009.635864257812500,
	0.388629436492920,
	0.388629436492920,
	0.388629436492920,
	0.388629466295242,
	0.388629615306854,
	0.388630270957947,
	0.388632446527481,
	0.388638287782669,
	0.388652026653290,
	0.388680964708328,
	0.388737171888351,
	0.388839364051819,
	0.389015465974808,
	0.389305442571640,
	0.389765083789825,
	0.390470147132874,
	0.391521364450455,
	0.393050163984299,
	0.395225107669830,
	0.398259431123734,
	0.402419328689575,
	0.408033192157745,
	0.415502041578293,
	0.425310820341110,
	0.438041120767593,
	0.454384744167328,
	0.475158959627151,
	0.501322567462921,
	0.533993542194366,
	0.574468493461609,
	0.624242782592773,
	0.685032546520233,
	0.758799135684967,
	0.847773194313049,
	0.954482078552246,
	1.081779599189758,
	1.232874631881714,
	1.411364197731018,
	1.621269226074219,
	1.867068171501160,
	2.153735876083374,
	2.486786842346191,
	2.872312307357788,
	3.317027807235718,
	3.828323125839233,
	4.414304256439209,
	5.083847999572754,
	5.846661090850830,
	6.713326930999756,
	7.695367813110352,
	8.805311203002930,
	10.056752204895020,
	11.464410781860352,
	13.044211387634277,
	14.813350677490234,
	16.790372848510742,
	18.995233535766602,
	21.449434280395508,
	24.176029205322266,
	27.199760437011719,
	30.547136306762695,
	34.246528625488281,
	38.328227996826172,
	42.824665069580078,
	47.770351409912109,
	53.202083587646484,
	59.159030914306641,
	65.682823181152344,
	72.817771911621094,
	80.610839843750000,
	89.111854553222656,
	98.373611450195312,
	108.452018737792969,
	119.406158447265625,
	131.298675537109375,
	144.195556640625000,
	158.166534423828125,
	173.285110473632812,
	189.628799438476562,
	207.279129028320312,
	226.322250366210938,
	246.848449707031250,
	268.952789306640625,
	292.735015869140625,
	318.300048828125000,
	345.757659912109375,
	375.223632812500000,
	406.818664550781250,
	440.669433593750000,
	476.908599853515625,
	515.674987792968750,
	557.113586425781250,
	601.376586914062500,
	648.622375488281250,
	699.016723632812500,
	752.732360839843750,
	809.949890136718750,
	870.857177734375000,
	935.651123046875000,
	1004.535827636718750,
	2.835555553436279,
	2.835555553436279,
	2.835555553436279,
	2.835555553436279,
	2.835555553436279,
	2.835556268692017,
	2.835558414459229,
	2.835564374923706,
	2.835577964782715,
	2.835607051849365,
	2.835663318634033,
	2.835765361785889,
	2.835941553115845,
	2.836231470108032,
	2.836691141128540,
	2.837396144866943,
	2.838447332382202,
	2.839976072311401,
	2.842151165008545,
	2.845185518264771,
	2.849345445632935,
	2.854959249496460,
	2.862428188323975,
	2.872236967086792,
	2.884967088699341,
	2.901310682296753,
	2.922085046768188,
	2.948248624801636,
	2.980919599533081,
	3.021394491195679,
	3.071168899536133,
	3.131958484649658,
	3.205725193023682,
	3.294699192047119,
	3.401408195495605,
	3.528705596923828,
	3.679800748825073,
	3.858290195465088,
	4.068195343017578,
	4.313994407653809,
	4.600661754608154,
	4.933712959289551,
	5.319238185882568,
	5.763953685760498,
	6.275249004364014,
	6.861230373382568,
	7.530774116516113,
	8.293587684631348,
	9.160252571105957,
	10.142293930053711,
	11.252237319946289,
	12.503678321838379,
	13.911336898803711,
	15.491137504577637,
	17.260276794433594,
	19.237298965454102,
	21.442159652709961,
	23.896360397338867,
	26.622955322265625,
	29.646686553955078,
	32.994064331054688,
	36.693454742431641,
	40.775154113769531,
	45.271591186523438,
	50.217277526855469,
	55.649009704589844,
	61.605957031250000,
	68.129745483398438,
	75.264701843261719,
	83.057762145996094,
	91.558776855468750,
	100.820541381835938,
	110.898948669433594,
	121.853088378906250,
	133.745605468750000,
	146.642486572265625,
	160.613464355468750,
	175.732040405273438,
	192.075714111328125,
	209.726058959960938,
	228.769180297851562,
	249.295379638671875,
	271.399688720703125,
	295.181945800781250,
	320.746978759765625,
	348.204589843750000,
	377.670562744140625,
	409.265563964843750,
	443.116363525390625,
	479.355529785156250,
	518.121948242187500,
	559.560546875000000,
	603.823547363281250,
	651.069335937500000,
	701.463623046875000,
	755.179321289062500,
	812.396789550781250,
	873.304138183593750,
	938.098022460937500,
	1006.982788085937500,
	0.322304189205170,
	0.322304189205170,
	0.322304189205170,
	0.322304219007492,
	0.322304368019104,
	0.322305053472519,
	0.322307258844376,
	0.322313189506531,
	0.322327107191086,
	0.322356432676315,
	0.322413414716721,
	0.322517037391663,
	0.322695523500443,
	0.322989523410797,
	0.323455482721329,
	0.324170261621475,
	0.325235962867737,
	0.326785773038864,
	0.328990668058395,
	0.332066804170609,
	0.336283951997757,
	0.341975152492523,
	0.349546819925308,
	0.359490662813187,
	0.372396260499954,
	0.388964951038361,
	0.410025209188461,
	0.436549067497253,
	0.469669878482819,
	0.510702192783356,
	0.561161816120148,
	0.622788667678833,
	0.697570979595184,
	0.787770152091980,
	0.895948410034180,
	1.024998784065247,
	1.178174376487732,
	1.359121561050415,
	1.571916937828064,
	1.821100473403931,
	2.111715316772461,
	2.449352264404297,
	2.840186357498169,
	3.291025400161743,
	3.809360980987549,
	4.403410911560059,
	5.082173824310303,
	5.855490684509277,
	6.734089851379395,
	7.729652881622314,
	8.854879379272461,
	10.123553276062012,
	11.550594329833984,
	13.152148246765137,
	14.945647239685059,
	16.949893951416016,
	19.185111999511719,
	21.673107147216797,
	24.437246322631836,
	27.502613067626953,
	30.896081924438477,
	34.646411895751953,
	38.784317016601562,
	43.342666625976562,
	48.356452941894531,
	53.862976074218750,
	59.901950836181641,
	66.515571594238281,
	73.748764038085938,
	81.649139404296875,
	90.267211914062500,
	99.656501770019531,
	109.873680114746094,
	120.978652954101562,
	133.034927368164062,
	146.109390258789062,
	160.272735595703125,
	175.599502563476562,
	192.168228149414062,
	210.061599731445312,
	229.366943359375000,
	250.175781250000000,
	272.584472656250000,
	296.694183349609375,
	322.611236572265625,
	350.446929931640625,
	380.318634033203125,
	412.348693847656250,
	446.665588378906250,
	483.403747558593750,
	522.703979492187500,
	564.713134765625000,
	609.585632324218750,
	657.481994628906250,
	708.570190429687500,
	763.025512695312500,
	821.030883789062500,
	882.776855468750000,
	948.462951660156250,
	1018.296203613281250,
	2.374009132385254,
	2.374009132385254,
	2.374009132385254,
	2.374009132385254,
	2.374009370803833,
	2.374010086059570,
	2.374012231826782,
	2.374018192291260,
	2.374032020568848,
	2.374061346054077,
	2.374118328094482,
	2.374222040176392,
	2.374400377273560,
	2.374694347381592,
	2.375160455703735,
	2.375875234603882,
	2.376940965652466,
	2.378490686416626,
	2.380695581436157,
	2.383771657943726,
	2.387988805770874,
	2.393680095672607,
	2.401251792907715,
	2.411195516586304,
	2.424101114273071,
	2.440669775009155,
	2.461730241775513,
	2.488254070281982,
	2.521374702453613,
	2.562407016754150,
	2.612866640090942,
	2.674493551254272,
	2.749275922775269,
	2.839475154876709,
	2.947653293609619,
	3.076703786849976,
	3.229879379272461,
	3.410826444625854,
	3.623621940612793,
	3.872805356979370,
	4.163420200347900,
	4.501057147979736,
	4.891891479492188,
	5.342730522155762,
	5.861065864562988,
	6.455115795135498,
	7.133879184722900,
	7.907195568084717,
	8.785795211791992,
	9.781357765197754,
	10.906584739685059,
	12.175257682800293,
	13.602299690246582,
	15.203853607177734,
	16.997352600097656,
	19.001598358154297,
	21.236818313598633,
	23.724811553955078,
	26.488950729370117,
	29.554319381713867,
	32.947788238525391,
	36.698116302490234,
	40.836021423339844,
	45.394371032714844,
	50.408157348632812,
	55.914680480957031,
	61.953655242919922,
	68.567276000976562,
	75.800468444824219,
	83.700843811035156,
	92.318916320800781,
	101.708206176757812,
	111.925384521484375,
	123.030357360839844,
	135.086639404296875,
	148.161102294921875,
	162.324447631835938,
	177.651199340820312,
	194.219924926757812,
	212.113311767578125,
	231.418655395507812,
	252.227478027343750,
	274.636169433593750,
	298.745880126953125,
	324.662933349609375,
	352.498626708984375,
	382.370330810546875,
	414.400390625000000,
	448.717285156250000,
	485.455474853515625,
	524.755676269531250,
	566.764831542968750,
	611.637329101562500,
	659.533691406250000,
	710.621887207031250,
	765.077209472656250,
	823.082580566406250,
	884.828552246093750,
	950.514648437500000,
	1020.347900390625000,
	0.346449553966522,
	0.346449553966522,
	0.346449553966522,
	0.346449553966522,
	0.346449732780457,
	0.346450388431549,
	0.346452593803406,
	0.346458494663239,
	0.346472322940826,
	0.346501529216766,
	0.346558213233948,
	0.346661299467087,
	0.346838891506195,
	0.347131371498108,
	0.347594976425171,
	0.348306119441986,
	0.349366396665573,
	0.350908339023590,
	0.353101998567581,
	0.356162458658218,
	0.360358178615570,
	0.366020411252975,
	0.373553574085236,
	0.383446812629700,
	0.396286755800247,
	0.412771135568619,
	0.433724254369736,
	0.460113137960434,
	0.493065446615219,
	0.533888995647430,
	0.584091901779175,
	0.645405173301697,
	0.719806969165802,
	0.809547245502472,
	0.917175114154816,
	1.045568823814392,
	1.197965025901794,
	1.377991676330566,
	1.589704394340515,
	1.837620019912720,
	2.126756429672241,
	2.462675333023071,
	2.851521015167236,
	3.300065994262695,
	3.815764427185059,
	4.406791687011719,
	5.082101345062256,
	5.851483345031738,
	6.725612640380859,
	7.716110229492188,
	8.835612297058105,
	10.097830772399902,
	11.517611503601074,
	13.111016273498535,
	14.895390510559082,
	16.889438629150391,
	19.113285064697266,
	21.588621139526367,
	24.338695526123047,
	27.388467788696289,
	30.764669418334961,
	34.495918273925781,
	38.612770080566406,
	43.147926330566406,
	48.136203765869141,
	53.614707946777344,
	59.622959136962891,
	66.202926635742188,
	73.399322509765625,
	81.259498596191406,
	89.833717346191406,
	99.175239562988281,
	109.340438842773438,
	120.388908386230469,
	132.383850097656250,
	145.391784667968750,
	159.483062744140625,
	174.731842041015625,
	191.216278076171875,
	209.018600463867188,
	228.225723266601562,
	248.928680419921875,
	271.223358154296875,
	295.210418701171875,
	320.995574951171875,
	348.689636230468750,
	378.409362792968750,
	410.276489257812500,
	444.418762207031250,
	480.970001220703125,
	520.070251464843750,
	561.865722656250000,
	606.509887695312500,
	654.162536621093750,
	704.990783691406250,
	759.169067382812500,
	816.879333496093750,
	878.311157226562500,
	943.663024902343750,
	1013.140930175781250,
	2.551857471466064,
	2.551857471466064,
	2.551857471466064,
	2.551857471466064,
	2.551857709884644,
	2.551858425140381,
	2.551860570907593,
	2.551866531372070,
	2.551880359649658,
	2.551909446716309,
	2.551966190338135,
	2.552069187164307,
	2.552246809005737,
	2.552539348602295,
	2.553003072738647,
	2.553714036941528,
	2.554774284362793,
	2.556316375732422,
	2.558510065078735,
	2.561570405960083,
	2.565766096115112,
	2.571428298950195,
	2.578961610794067,
	2.588854789733887,
	2.601694822311401,
	2.618179082870483,
	2.639132261276245,
	2.665521144866943,
	2.698473453521729,
	2.739296913146973,
	2.789499759674072,
	2.850813150405884,
	2.925215005874634,
	3.014955282211304,
	3.122583150863647,
	3.250976800918579,
	3.403373003005981,
	3.583399772644043,
	3.795112371444702,
	4.043027877807617,
	4.332164287567139,
	4.668083190917969,
	5.056929111480713,
	5.505474090576172,
	6.021172523498535,
	6.612199783325195,
	7.287509441375732,
	8.056891441345215,
	8.931020736694336,
	9.921518325805664,
	11.041019439697266,
	12.303237915039062,
	13.723019599914551,
	15.316424369812012,
	17.100797653198242,
	19.094846725463867,
	21.318693161010742,
	23.794029235839844,
	26.544103622436523,
	29.593875885009766,
	32.970077514648438,
	36.701328277587891,
	40.818176269531250,
	45.353336334228516,
	50.341609954833984,
	55.820117950439453,
	61.828365325927734,
	68.408332824707031,
	75.604728698730469,
	83.464904785156250,
	92.039123535156250,
	101.380645751953125,
	111.545845031738281,
	122.594314575195312,
	134.589248657226562,
	147.597198486328125,
	161.688476562500000,
	176.937255859375000,
	193.421676635742188,
	211.224014282226562,
	230.431137084960938,
	251.134094238281250,
	273.428771972656250,
	297.415802001953125,
	323.200988769531250,
	350.895050048828125,
	380.614776611328125,
	412.481872558593750,
	446.624176025390625,
	483.175415039062500,
	522.275634765625000,
	564.071105957031250,
	608.715270996093750,
	656.367919921875000,
	707.196228027343750,
	761.374450683593750,
	819.084716796875000,
	880.516540527343750,
	945.868408203125000,
	1015.346374511718750,
	0.367924124002457,
	0.367924124002457,
	0.367924124002457,
	0.367924153804779,
	0.367924302816391,
	0.367924988269806,
	0.367927163839340,
	0.367933034896851,
	0.367946833372116,
	0.367975920438766,
	0.368032395839691,
	0.368135094642639,
	0.368312001228333,
	0.368603378534317,
	0.369065225124359,
	0.369773685932159,
	0.370829939842224,
	0.372366040945053,
	0.374551415443420,
	0.377600312232971,
	0.381780147552490,
	0.387420952320099,
	0.394925594329834,
	0.404781430959702,
	0.417572766542435,
	0.433994770050049,
	0.454868584871292,
	0.481157630681992,
	0.513985276222229,
	0.554654300212860,
	0.604667246341705,
	0.665748536586761,
	0.739868819713593,
	0.829269528388977,
	0.936490178108215,
	1.064398050308228,
	1.216217637062073,
	1.395563125610352,
	1.606474637985229,
	1.853452205657959,
	2.141494512557983,
	2.476142406463623,
	2.863516569137573,
	3.310364484786987,
	3.824111700057983,
	4.412902832031250,
	5.085657119750977,
	5.852128028869629,
	6.722949504852295,
	7.709699153900146,
	8.824964523315430,
	10.082406997680664,
	11.496815681457520,
	13.084191322326660,
	14.861813545227051,
	16.848316192626953,
	19.063749313354492,
	21.529718399047852,
	24.269388198852539,
	27.307619094848633,
	30.671045303344727,
	34.388175964355469,
	38.489448547363281,
	43.007446289062500,
	47.976848602294922,
	53.434623718261719,
	59.420139312744141,
	65.975212097167969,
	73.144371032714844,
	80.974807739257812,
	89.516586303710938,
	98.822761535644531,
	108.949493408203125,
	119.956161499023438,
	131.905715942382812,
	144.864425659179688,
	158.902389526367188,
	174.093460083007812,
	190.515518188476562,
	208.250488281250000,
	227.384933471679688,
	248.009552001953125,
	270.219879150390625,
	294.116149902343750,
	319.803771972656250,
	347.393035888671875,
	377.000305175781250,
	408.746826171875000,
	442.759918212890625,
	479.172882080078125,
	518.125183105468750,
	559.762451171875000,
	604.237731933593750,
	651.710083007812500,
	702.346008300781250,
	756.319274902343750,
	813.811157226562500,
	875.010498046875000,
	940.115112304687500,
	1009.330139160156250,
	2.710033893585205,
	2.710033893585205,
	2.710033893585205,
	2.710033893585205,
	2.710033893585205,
	2.710034608840942,
	2.710036754608154,
	2.710042715072632,
	2.710056543350220,
	2.710085630416870,
	2.710142135620117,
	2.710244655609131,
	2.710421562194824,
	2.710713148117065,
	2.711174964904785,
	2.711883306503296,
	2.712939500808716,
	2.714475631713867,
	2.716660976409912,
	2.719709873199463,
	2.723889827728271,
	2.729530572891235,
	2.737035274505615,
	2.746891021728516,
	2.759682416915894,
	2.776104450225830,
	2.796978235244751,
	2.823267221450806,
	2.856094837188721,
	2.896764039993286,
	2.946776866912842,
	3.007858276367188,
	3.081978559494019,
	3.171379089355469,
	3.278599739074707,
	3.406507730484009,
	3.558327198028564,
	3.737672805786133,
	3.948584318161011,
	4.195561885833740,
	4.483603954315186,
	4.818252086639404,
	5.205626487731934,
	5.652474403381348,
	6.166221141815186,
	6.755012035369873,
	7.427766799926758,
	8.194237709045410,
	9.065058708190918,
	10.051808357238770,
	11.167074203491211,
	12.424516677856445,
	13.838925361633301,
	15.426301002502441,
	17.203922271728516,
	19.190425872802734,
	21.405858993530273,
	23.871828079223633,
	26.611497879028320,
	29.649728775024414,
	33.013156890869141,
	36.730285644531250,
	40.831558227539062,
	45.349555969238281,
	50.318958282470703,
	55.776733398437500,
	61.762248992919922,
	68.317321777343750,
	75.486480712890625,
	83.316917419433594,
	91.858695983886719,
	101.164871215820312,
	111.291603088378906,
	122.298271179199219,
	134.247817993164062,
	147.206542968750000,
	161.244506835937500,
	176.435577392578125,
	192.857635498046875,
	210.592605590820312,
	229.727035522460938,
	250.351669311523438,
	272.561981201171875,
	296.458251953125000,
	322.145874023437500,
	349.735137939453125,
	379.342407226562500,
	411.088928222656250,
	445.102050781250000,
	481.514984130859375,
	520.467285156250000,
	562.104553222656250,
	606.579833984375000,
	654.052185058593750,
	704.688110351562500,
	758.661376953125000,
	816.153259277343750,
	877.352600097656250,
	942.457214355468750,
	1011.672241210937500,
	0.387374907732010,
	0.387374907732010,
	0.387374907732010,
	0.387374937534332,
	0.387375086545944,
	0.387375742197037,
	0.387377917766571,
	0.387383788824081,
	0.387397527694702,
	0.387426525354385,
	0.387482821941376,
	0.387585222721100,
	0.387761652469635,
	0.388052165508270,
	0.388512641191483,
	0.389219015836716,
	0.390272170305252,
	0.391803741455078,
	0.393982678651810,
	0.397022575139999,
	0.401190102100372,
	0.406814277172089,
	0.414296835660934,
	0.424123615026474,
	0.436877280473709,
	0.453250914812088,
	0.474063247442245,
	0.500274837017059,
	0.533005774021149,
	0.573554992675781,
	0.623420655727386,
	0.684321999549866,
	0.758223950862885,
	0.847361266613007,
	0.954266011714935,
	1.081797122955322,
	1.233169436454773,
	1.411986589431763,
	1.622276902198792,
	1.868526935577393,
	2.155720710754395,
	2.489382743835449,
	2.875615835189819,
	3.321147441864014,
	3.833381175994873,
	4.420437335968018,
	5.091209888458252,
	5.855422973632812,
	6.723679065704346,
	7.707522392272949,
	8.819502830505371,
	10.073240280151367,
	11.483482360839844,
	13.066182136535645,
	14.838567733764648,
	16.819219589233398,
	19.028123855590820,
	21.486829757690430,
	24.218427658081055,
	27.247709274291992,
	30.601228713989258,
	34.307407379150391,
	38.396598815917969,
	42.901290893554688,
	47.856048583984375,
	53.297748565673828,
	59.265632629394531,
	65.801391601562500,
	72.949440002441406,
	80.756805419921875,
	89.273422241210938,
	98.552177429199219,
	108.649078369140625,
	119.623321533203125,
	131.537673950195312,
	144.458221435546875,
	158.454833984375000,
	173.601150512695312,
	189.974822998046875,
	207.657562255859375,
	226.735626220703125,
	247.299499511718750,
	269.444396972656250,
	293.270263671875000,
	318.882202148437500,
	346.390228271484375,
	375.910247802734375,
	407.563262939453125,
	441.476165771484375,
	477.781860351562500,
	516.619384765625000,
	558.134033203125000,
	602.478271484375000,
	649.810791015625000,
	700.297546386718750,
	754.111816406250000,
	811.434326171875000,
	872.453430175781250,
	937.366210937500000,
	1006.377380371093750,
	2.853303194046021,
	2.853303194046021,
	2.853303194046021,
	2.853303194046021,
	2.853303194046021,
	2.853303909301758,
	2.853306055068970,
	2.853312015533447,
	2.853325843811035,
	2.853354692459106,
	2.853410959243774,
	2.853513479232788,
	2.853689908981323,
	2.853980302810669,
	2.854440927505493,
	2.855147361755371,
	2.856200456619263,
	2.857732057571411,
	2.859910964965820,
	2.862950801849365,
	2.867118358612061,
	2.872742414474487,
	2.880224943161011,
	2.890051841735840,
	2.902805566787720,
	2.919179201126099,
	2.939991474151611,
	2.966202974319458,
	2.998934030532837,
	3.039483308792114,
	3.089348793029785,
	3.150250196456909,
	3.224152088165283,
	3.313289403915405,
	3.420194149017334,
	3.547725439071655,
	3.699097633361816,
	3.877914905548096,
	4.088205337524414,
	4.334455013275146,
	4.621648788452148,
	4.955310821533203,
	5.341544151306152,
	5.787075519561768,
	6.299309253692627,
	6.886365890502930,
	7.557138442993164,
	8.321351051330566,
	9.189607620239258,
	10.173450469970703,
	11.285430908203125,
	12.539169311523438,
	13.949410438537598,
	15.532110214233398,
	17.304496765136719,
	19.285146713256836,
	21.494052886962891,
	23.952758789062500,
	26.684356689453125,
	29.713638305664062,
	33.067157745361328,
	36.773338317871094,
	40.862529754638672,
	45.367218017578125,
	50.321979522705078,
	55.763679504394531,
	61.731559753417969,
	68.267318725585938,
	75.415367126464844,
	83.222732543945312,
	91.739349365234375,
	101.018104553222656,
	111.115013122558594,
	122.089248657226562,
	134.003601074218750,
	146.924148559570312,
	160.920761108398438,
	176.067077636718750,
	192.440750122070312,
	210.123489379882812,
	229.201553344726562,
	249.765426635742188,
	271.910308837890625,
	295.736206054687500,
	321.348144531250000,
	348.856140136718750,
	378.376190185546875,
	410.029205322265625,
	443.942108154296875,
	480.247772216796875,
	519.085327148437500,
	560.599975585937500,
	604.944213867187500,
	652.276672363281250,
	702.763488769531250,
	756.577758789062500,
	813.900268554687500,
	874.919372558593750,
	939.832153320312500,
	1008.843322753906250
};

/** Static on-PL memories */
#if AST_UNROLL && ACCEL
static real st_kcross[NUM_KCROSS][N_AGENTS];
#else
static real st_kcross[N_AGENTS];
#endif
static real st_kprimes[NUM_KPRIMES][NSTATES];
static hw_env_t st_env;
static real st_kmts_init;

/**
 * First-time setup as separate top-level function
 */
// #pragma SDS data copy(kp_in[0:NSTATES])
// #pragma SDS data access_pattern(kp_in:SEQUENTIAL)
// #pragma SDS data mem_attribute(kp_in:PHYSICAL_CONTIGUOUS)
void hw_top_init(bool first,
				 const real kp_in[NSTATES],
				 const real kcross_init)
{
	#pragma HLS array_partition variable=st_kprimes complete dim=1
	#if AST_UNROLL && ACCEL
	#pragma HLS array_partition variable=st_kcross complete dim=1
	#endif

	st_kmts_init = env__kss;

	// SIMPLE
	for (int j = 0; j < NSTATES; ++j) {
		#if ACCEL_SETUP
		#pragma HLS pipeline
		#endif
		real val = kp_in[j];
		if (first)
			for (int k = 0; k < NUM_KPRIMES; ++k)
				st_kprimes[k][j] = kp_in[j];
	}

	if (first) {
		for (int j = 0; j < N_AGENTS; ++j) {
			#if ACCEL_SETUP
			#pragma HLS unroll factor=2
			#endif 

			#if AST_UNROLL && ACCEL
			for (int i = 0; i < NUM_KCROSS; ++i)
				st_kcross[i][j] = kcross_init;
			#else
			st_kcross[j] = kcross_init;
			#endif
		}
		force_init_env();
	}
	return;
}

// #pragma SDS data copy(env);
#pragma SDS data copy(agshock[0:AGSHOCK_ARR_SIZE])
#pragma SDS data copy(idshock[0:IDSHOCK_HW_ARR_SIZE])
#pragma SDS data access_pattern(agshock:SEQUENTIAL)
#pragma SDS data access_pattern(idshock:SEQUENTIAL)
#pragma SDS data mem_attribute(agshock:PHYSICAL_CONTIGUOUS)
#pragma SDS data mem_attribute(idshock:PHYSICAL_CONTIGUOUS)

#pragma SDS data copy(kp_in[0:NSTATES])
#pragma SDS data access_pattern(kp_in:SEQUENTIAL)
#pragma SDS data mem_attribute(kp_in:PHYSICAL_CONTIGUOUS)

#pragma SDS data copy(coeff[0:NCOEFF])
#pragma SDS data copy(kmts[0:SIM_STEPS])
#pragma SDS data access_pattern(coeff:SEQUENTIAL)
#pragma SDS data access_pattern(kmts:SEQUENTIAL)
#pragma SDS data mem_attribute(coeff:PHYSICAL_CONTIGUOUS)
#pragma SDS data mem_attribute(kmts:PHYSICAL_CONTIGUOUS)

#if OUTPUT_KP
	#pragma SDS data copy(kp_final[0:NSTATES])
	#pragma SDS data access_pattern(kp_final:SEQUENTIAL)
	#pragma SDS data mem_attribute(kp_final:PHYSICAL_CONTIGUOUS)
#endif
void hw_top(bool first,
			// const env_t env,
			const real coeff[NCOEFF],
#if OUT_DEBUG_DATA
			int *egms,
			int *asts,
#endif
			const unsigned char agshock[AGSHOCK_ARR_SIZE],
			const ids_sw_t idshock[IDSHOCK_HW_ARR_SIZE],
			const real kp_in[NSTATES],
			const real kcross_init,
#if OUTPUT_KP
			real kp_final[NSTATES],
#endif
			real kmts[SIM_STEPS])
{
	#pragma HLS array_partition variable=st_kprimes complete dim=1
	#pragma HLS array_partition variable=st_env.P complete
	/** STATE: static across top-level calls */
	// static real kcross[N_AGENTS];
	// // #pragma HLS array_partition variable=kcross cyclic factor=
	// static real kprimes[NUM_KPRIMES][NSTATES];
	// #pragma HLS array_partition variable=kprimes complete dim=1
	// static hw_env_t env;
	// #pragma HLS array_partition variable=env.P complete


	// Local
	real kmprime[NSTATES_AG * NKM_GRID];
	// #pragma HLS stream variable=kmprime
	#pragma HLS array_partition variable=kmprime complete

	/**
	 * SETUP:
	 */
	// hw_setup_state(first, env, kprimes, kcross);
	hw_top_init(first, kp_in, kcross_init);

	/**
	 * ALM:
	 *	Consumes:
	 *		coeff[]: from external
	 *	Produces:
	 *		kmprime[] stream to EGM
	 */
	hw_sim_alm(kmprime, coeff);

	/**
	 * EGM:
	 *	Consumes:
	 *		kmprime[]: in order
	 *	Updates:
	 *		kprimes[]
	 */
#if OUT_DEBUG_DATA
	hw_sim_egm(kmprime, egms);
#else
	#if OUTPUT_KP
	hw_sim_egm(kmprime, kp_final);
	#else
	hw_sim_egm(kmprime);
	#endif
#endif

	/**
	 * AST:
	 * 	Consumes:
	 *		kprimes: for interpolation
	 *		agshock: from external
	 *		idshock: from external
	 *		kcross: old values, updated in place
	 *	Produces:
	 *		kmts: to external (for sim_alm_coeff)
	 *		kcross: updates static state
	 */
	hw_sim_ast(
			   agshock,
			   idshock,
			   #if OUT_DEBUG_DATA
			   asts,
			   #endif
			   kmts);

	return;
}

/** Aggregate Law of Motion */
void hw_sim_alm(
				real kmprime[NSTATES_AG * NKM_GRID],
				const real coeff[NCOEFF])
{
	// Exp cost: 1869 LUT - 925 Reg - 35 C8 - 424 f7mux - 7 f8mux - 26 DSP
	// Hence, pipeline inner loop only

	small_idx_t cidx = 0;
	real c0, c1;
	small_idx_t kidx = 0;

	for (int ia = 0; ia < NSTATES_AG; ++ia) {
		c0 = coeff[cidx];
		c1 = coeff[cidx + 1];
		cidx += REGRESSORS;
		for (int ikm = 0; ikm < NKM_GRID; ++ikm) {
			#if ACCEL
			#pragma HLS pipeline
			#endif
			real val = hw_exp(c0
					  + c1
					  * st_env.log_env_km[ikm]);
			hw_rail_values(&val, KM_MAX, KM_MIN);
			kmprime[kidx++] = val;
		}
	}
	return;
}

/** Agents EGM */
#if OUT_DEBUG_DATA
void hw_sim_egm(
				const real kmprime[NSTATES_AG * NKM_GRID],
				int *egms)
#elif OUTPUT_KP
void hw_sim_egm(const real kmprime[NSTATES_AG * NKM_GRID],
				real kp_final[NSTATES])
#else
void hw_sim_egm(const real kmprime[NSTATES_AG * NKM_GRID])
#endif
{
	#pragma HLS array_partition variable=st_kprimes complete dim=1
	#pragma HLS array_partition variable=st_env.P complete

	#if AST_UNROLL && ACCEL
	#pragma HLS array_partition variable=st_env.k complete dim=1
	#pragma HLS array_partition variable=st_env.epsilon2 complete dim=1
	#endif

	/** Lookup tables */
	static const small_idx_t li_2d_aux_idx_base[4] = {
		0,
		100,
		800,
		900
	};
	#pragma HLS array_partition variable=li_2d_aux_idx_base complete

	// Local kprime/new copies
	real kprime_new[NSTATES]; 
	real metric = 1;
	#if OUT_DEBUG_DATA
	unsigned int iter_cnt = 0;
	#endif

	// Convergence loop: 4x1600 interp over kprime[]
	// ^^ Loop 1
	while (metric > (real) TOLL_K) {
		#pragma HLS loop_tripcount min=20 avg=20 max=600

		#if SPREAD_SCALAR_TRICK
		real spread_scalar[2] = {VERY_SMALL_SCALAR, VERY_SMALL_SCALAR};
		#else
		real spread_scalar = VERY_SMALL_SCALAR;
		#endif

		#if EGM_ONE_LOOP
		// Reset index values for [1600] loop
		pidx_t p_idx_outer = 0b0100;
		small_idx_t hundreds_cnt = 100;
		small_idx_t kp_iter_cnt = (NSTATES_ID * NKGRID);
		small_idx_t kidx = 0;
		
		// ^^ Loop 1.1: 1600 * 4x LI2D over kprime[] --> kprime_new[]
		for (small_idx_t is = 0; is < NSTATES; ++is) {
			#if !SMALL_PL && ACCEL
			#pragma HLS pipeline
			#elif SMALL_PL_MAX_ACCEL && ACCEL
			#pragma HLS pipeline
			#endif
			
			pidx_t p_idx_inner = 0;
			emu_s_t emu_s = 0.;
			real kmp, temp_base;
			real kp = st_kprimes[8][is];

			// Index handling
			if (++kp_iter_cnt >= NSTATES_ID * NKGRID) {
				kp_iter_cnt = 0;
				kmp = kmprime[kidx++];
				temp_base = kmp * (real) env__l_bar_inv;
			}
			if (++hundreds_cnt >= 100) {
				hundreds_cnt = 0;
				p_idx_outer ^= (pidx_t) 0b0100;
			}
			if (is == (NKM_GRID * NSTATES_ID * NKGRID))
				p_idx_outer |= (pidx_t) 0b1000;
			p_idx_inner = 0;
			
			// 4x EGM 2D interpolation over kprime[]
			// Loop 1.1.1
			for (int iap = 0; iap < NSTATES_AG; ++iap) {
				real temp = temp_base * st_env.er_inv[iap];
				real irate = st_env.irate_factor[iap]
							 * hw_pow(temp, env__alpha_c);
				real imrt = env__delta_c + irate;
				real wage = st_env.wage_factor[iap] * hw_pow(temp, env__alpha);
				small_idx_t kpb = iap << 2;

				for (int iidp = 0; iidp < NSTATES_ID; ++iidp) {
					#if SMALL_PL && ACCEL
					#pragma HLS pipeline
					#endif

					#if OLD_INLINE_2D
					range_t i1 = hw_findrange(kmp, st_env.km_egm, NKM_GRID);
					range_t i2 = hw_findrange(kp, st_env.k_egm, NKGRID);
					small_idx_t idx_base = li_2d_aux_idx_base[p_idx_inner];
					small_idx_t i1_min_base = idx_base + (NSTATES_ID * NKGRID * i1.min);
					small_idx_t i1_max_base = idx_base + (NSTATES_ID * NKGRID * i1.max);

					real tz = (kmp - i1.min_val) / (i1.max_val - i1.min_val);
					real tw = (kp - i2.min_val) / (i2.max_val - i2.min_val);
	
					real fp = st_kprimes[kpb+0][i1_min_base + i2.min]
								* ((real)1.0 - tz) * ((real)1.0 - tw) +
							  st_kprimes[kpb+1][i1_min_base + i2.max]
								* ((real)1.0 - tz) *      tw  +
							  st_kprimes[kpb+2][i1_max_base + i2.min]
								*        tz  * ((real)1.0 - tw) +
							  st_kprimes[kpb+3][i1_max_base + i2.max]
								*        tz  *      tw;
					#else
					real fp = hw_li_2d_aux(kmp,
										   kp,
										   st_env.km_egm,
										   st_env.k_egm,
										   st_kprimes,
										   kpb,
										   li_2d_aux_idx_base[p_idx_inner]);
					#endif

					real cons2 = (imrt * kp
								 + wage * st_env.cons2_factor[p_idx_inner]
								 ) - fp;
					if (cons2 < 0)
						cons2 = CONS2_MIN;
					real mu2 = hw_pow(cons2, env__gamma_neg);
					emu_s += (emu_s_t) (st_env.P[p_idx_outer + p_idx_inner] * imrt * mu2);
					++p_idx_inner;
				}
			} // end 4x EGM interpolation over kprime[]
			// if (emu_s > 3.0)
			// 	printf("            ~~ emu_s %18.15lf\n", emu_s);
			// ~ Today (each 4x interpolate yields one new kprime value)
			real new_kp = st_env.wealth[is]
						  - hw_pow(env__beta * (real)emu_s, env__gamma_neg_inv);
			hw_rail_values(&new_kp, KMAX, KMIN);
			// ~ Convergence check
			
			real spread = fabs(new_kp - kp);
			#if SPREAD_SCALAR_TRICK
			#ifdef __SYNTHESIS__
			ap_uint<16> is_ap_uint = is;
			small_idx_t ssidx = is_ap_uint.get_bit(0);
			#else
			small_idx_t ssidx = is % 2;
			#endif
			if (spread > spread_scalar[ssidx])
				spread_scalar[ssidx] = spread;
			#else
			if (spread > spread_scalar)
				spread_scalar = spread;
			#endif
			kprime_new[is] = new_kp;
		}

		#elif !EGM_ONE_LOOP
		for (int ia = 0; ia < NSTATES_AG; ++ia)
			for (int ikm = 0; ikm < NKM_GRID; ++ikm) {
				real kmp = kmprime[IXAKM(ia, ikm)];
				for (int iid = 0; iid < NSTATES_ID; ++iid)
					for (int ik = 0; ik < NKGRID; ++ik) {
						#if !SMALL_PL && ACCEL
						#pragma HLS pipeline
						#elif SMALL_PL_MAX_ACCEL && ACCEL
						#pragma HLS pipeline
						#endif
						real kp = st_kprimes[8][IXV(ia, ikm, iid, ik)];
						emu_s_t emu_s = 0.;
						real temp_base = kmp * st_env.l_bar_inv;

						// EGM interpolation over kprime[] loop
						for (int iap = 0; iap < NSTATES_AG; ++iap) {
							real temp = temp_base * st_env.er_inv[iap];
							real irate = st_env.irate_factor[iap]
										 * hw_pow(temp, env__alpha - 1.);
							real imrt = (1. - env__delta) + irate;
							real wage = st_env.wage_factor[iap] 
										* hw_pow(temp, env__alpha);
							small_idx_t kpb = iap << 2;
							for (int iidp = 0; iidp < NSTATES_ID; ++iidp) {
								#if SMALL_PL && ACCEL
								#pragma HLS pipeline
								#endif
								// HW_LI_2D_AUX
								range_t i1 = hw_findrange(kmp, st_env.km_egm, NKM_GRID);
								range_t i2 = hw_findrange(kp, st_env.k_egm, NKGRID);
								small_idx_t idx_base = li_2d_aux_idx_base[IXAI(iap, iidp)];
								small_idx_t i1_min_base = idx_base + (NSTATES_ID * NKGRID * i1.min);
								small_idx_t i1_max_base = idx_base + (NSTATES_ID * NKGRID * i1.max);

								small_idx_t fidx0 = i1_min_base + i2.min;
								small_idx_t fidx1 = i1_min_base + i2.max;
								small_idx_t fidx2 = i1_max_base + i2.min;
								small_idx_t fidx3 = i1_max_base + i2.max;

								real tz = (kmp - i1.min_val) / (i1.max_val - i1.min_val);
								real tw = (kp - i2.min_val) / (i2.max_val - i2.min_val);

								real fp = st_kprimes[kpb+0][fidx0] * (1.0 - tz) * (1.0 - tw) +
									st_kprimes[kpb+1][fidx1] * (1.0 - tz) *      tw  +
									st_kprimes[kpb+2][fidx2] *        tz  * (1.0 - tw) +
									st_kprimes[kpb+3][fidx3] *        tz  *      tw;
								real cons2 = ((irate + 1. - env__delta) * kp
										 + wage * st_env.cons2_factor[IXAI(iap, iidp)]
										 ) - fp;
								if (cons2 < 0)
									cons2 = CONS2_MIN;
								real mu2 = hw_pow(cons2, env__gamma_neg);
								emu_s += (emu_s_t) (st_env.P[IXP(ia, iid, iap, iidp)] * imrt * mu2);
							}
						}
						// ~ Today
						real new_kp = st_env.wealth[IXV(ia, ikm, iid, ik)]
					 			 - hw_pow(env__beta * (real) emu_s, env__gamma_neg_inv);
						hw_rail_values(&new_kp, KMAX, KMIN);
						real spread = fabs(new_kp - kp);
						if (spread > spread_scalar)
							spread_scalar = spread;
						kprime_new[IXV(ia, ikm, iid, ik)] = new_kp;
					}
			}
		#endif

		// ~Update guess: new kprimes[] for next top-level call
		for (small_idx_t is = 0; is < NSTATES; ++is) {
			#if ACCEL
			#pragma HLS pipeline
			#endif
			real updated_kp = UPDATE_K * kprime_new[is] 
							  + UPDATE_K_C * st_kprimes[0][is];
			for (small_idx_t k = 0; k < NUM_KPRIMES; ++k)
				st_kprimes[k][is] = updated_kp;
		}

		// ~ Update metric
		#if SPREAD_SCALAR_TRICK
		if (spread_scalar[1] >= spread_scalar[0])
			metric = spread_scalar[1];
		else
			metric = spread_scalar[0];
		#else
		metric = spread_scalar;
		#endif

		#if OUT_DEBUG_DATA
		++iter_cnt;
		#endif
	}

	#if OUT_DEBUG_DATA
	*egms = iter_cnt;
	#endif

	#if OUTPUT_KP
	// For floating point test (or other purposes?) we want to save final kprime values
	for (int is = 0; is < NSTATES; ++is) {
		kp_final[is] = st_kprimes[8][is];
	}
	#endif
	return;
}

/** Aggregate ST */
void hw_sim_ast(
				const unsigned char agshock[AGSHOCK_ARR_SIZE],
				const ids_sw_t idshock[IDSHOCK_HW_ARR_SIZE],
				// const real kprimes[NUM_KPRIMES][NSTATES],
				// real kcross[N_AGENTS],
				#if OUT_DEBUG_DATA
				int *asts,
				#endif
				real kmts[SIM_STEPS])
{
	#pragma HLS array_partition variable=st_kprimes complete dim=1

	#if AST_UNROLL && ACCEL
	real kprime_interp0[NUM_KCROSS][NSTATES_ID * NKGRID];
	real kprime_interp1[NUM_KCROSS][NSTATES_ID * NKGRID];
	#else
	real kprime_interp0[NSTATES_ID * NKGRID];
	real kprime_interp1[NSTATES_ID * NKGRID];
	#endif

	#if AST_UNROLL && ACCEL
	// #pragma HLS array_partition variable=st_env.k complete dim=1
	#pragma HLS array_partition variable=st_env.epsilon2 complete dim=1
	#pragma HLS array_partition variable=st_kcross complete dim=1
	#pragma HLS array_partition variable=kprime_interp0 complete dim=1
	#pragma HLS array_partition variable=kprime_interp1 complete dim=1
	#endif

	real curr_kmts = st_kmts_init;
	idx_t idshock_idx = 0;
	idx_t agshock_idx = 0;
	ids_hw_t curr_ids;
	shock_t curr_ags;
	apu4_t ags_phase = AGS_PACK_FACTOR;

	#if OUT_DEBUG_DATA
	int curr_sum_cnt = 0;
	#endif

	// Loop 1
	for (int t = 0; t < SIM_STEPS; ++t) {
		kc_t curr_sum = 0;
		kmts[t] = curr_kmts;

		// Read next packed agshock value when needed
		if (++ags_phase >= AGS_PACK_FACTOR) {
			curr_ags = agshock[agshock_idx++];
			ags_phase = 0;
		}

		#ifdef __SYNTHESIS__
		real p0 = curr_ags.get_bit(ags_phase) ? (real)1.0 : (real)0.0;
		#else
		real p0 = (curr_ags & 0b1) ? (real)1.0 : (real)0.0;
		curr_ags >>= 1;
 		#endif

		/** 
		 * (C): AST kprime_interp over kprime
		 *	f(env, agshock[t], curr_kmts, kprimes)
		 */
		// real p0 = agshock[t] ? (real)1.0 : (real)0.0;
		real p1 = curr_kmts;

		range_t i1 = hw_findrange(p0, st_env.ag2, NSTATES_AG);
		range_t i2 = hw_findrange(p1, st_env.km, NKM_GRID);
		real tx = (p0 - i1.min_val) / (i1.max_val - i1.min_val);
		real ty = (p1 - i2.min_val) / (i2.max_val - i2.min_val);

		real P = ((real)1.0 - tx) * ((real)1.0 - ty);
		real Q = ((real)1.0 - tx) * ty;
		real R = tx * ((real)1.0 - ty);
		real S = tx * ty;

		small_idx_t i1_min_base = L4D_D3 * i1.min;
		small_idx_t i1_max_base = L4D_D3 * i1.max;
		small_idx_t i2_min_base = L4D_D2 * i2.min;
		small_idx_t i2_max_base = L4D_D2 * i2.max;

		small_idx_t i12_min_min = i1_min_base + i2_min_base;
		small_idx_t i12_min_max = i1_min_base + i2_max_base;
		small_idx_t i12_max_min = i1_max_base + i2_min_base;
		small_idx_t i12_max_max = i1_max_base + i2_max_base;
		/** Produces[1100]
		 *	i12_min_min (11 bits: max should be 800 + 600
		 *	i12_min_max (11 bits):
		 *	i12_max_min (11 bits):
		 *	i12_max_max (11 bits):
		 *	P, Q, R, S
		 */

		small_idx_t kpi_idx = 0;

		// Loop 1.1
		for (int iid = 0; iid < NSTATES_ID; ++iid) {
			// Can pipeline this too if we double the # of kprimes; see EGM
			// ** UPDATE DIMM3
			/*** Move to initialization
			 * Produces:
			 *	i3_min_base[2]
			 *	i3_max_base[2]
			 *	tz[2]
			 */
			real p2 = st_env.epsilon[iid];
			#if AST_UNROLL && ACCEL
			range_t i3 = hw_findrange(p2, st_env.epsilon2[0], NSTATES_ID);
			#else
			range_t i3 = hw_findrange(p2, st_env.epsilon2, NSTATES_ID);
			#endif
			real tz = (p2 - i3.min_val) / (i3.max_val - i3.min_val);
			small_idx_t i3_min_base = L4D_D1 * i3.min;
			small_idx_t i3_max_base = L4D_D1 * i3.max;
			
			// Loop 1.1.1
			for (int ik = 0; ik < NKGRID; ++ik) {
				#if !SMALL_PL && ACCEL
				#pragma HLS pipeline
				#else
				// #pragma HLS pipeline II=1
				#endif
				// ** UPDATE DIMM4

				real p3 = st_env.k_egm[ik];
				range_t i4 = hw_findrange(p3, st_env.k_egm, NKGRID);

//				printf("---%d %d %d---\n", ik, i4.min, i4.max);
				//assert((i4.min == ik && i4.max ==ik+1) ||
					   //(i4.min == ik - 1 && i4.max == ik));

//				range_t i4;
//				if (ik == NKGRID - 1) {
//					i4.min = ik - 1;
//					i4.max = ik;
//					i4.min_val = st_env.k_egm[i4.min];
//					i4.max_val = st_env.k_egm[i4.max];
//				} else {
//					i4.min = ik;
//					i4.max = ik + 1;
//					i4.min_val = st_env.k_egm[i4.min];
//					i4.max_val = st_env.k_egm[i4.max];
//				}
				
				real tw = (p3 - i4.min_val) / (i4.max_val - i4.min_val);

				real p = ((real)1.0 - tz) * ((real)1.0 - tw);
				real q = ((real)1.0 - tz) * tw;
				real r = tz * ((real)1.0 - tw);
				real s = tz * tw;

				small_idx_t kp_idx_0  = i4.min + i3_min_base + i12_min_min;
				small_idx_t kp_idx_1  = i4.max + i3_min_base + i12_min_min;
				small_idx_t kp_idx_2  = i4.min + i3_max_base + i12_min_min;
				small_idx_t kp_idx_3  = i4.max + i3_max_base + i12_min_min;
				small_idx_t kp_idx_4  = i4.min + i3_min_base + i12_min_max;
				small_idx_t kp_idx_5  = i4.max + i3_min_base + i12_min_max;
				small_idx_t kp_idx_6  = i4.min + i3_max_base + i12_min_max;
				small_idx_t kp_idx_7  = i4.max + i3_max_base + i12_min_max;
				small_idx_t kp_idx_8  = i4.min + i3_min_base + i12_max_min;
				small_idx_t kp_idx_9  = i4.max + i3_min_base + i12_max_min;
				small_idx_t kp_idx_10 = i4.min + i3_max_base + i12_max_min;
				small_idx_t kp_idx_11 = i4.max + i3_max_base + i12_max_min;
				small_idx_t kp_idx_12 = i4.min + i3_min_base + i12_max_max;
				small_idx_t kp_idx_13 = i4.max + i3_min_base + i12_max_max;
				small_idx_t kp_idx_14 = i4.min + i3_max_base + i12_max_max;
				small_idx_t kp_idx_15 = i4.max + i3_max_base + i12_max_max;

				// ** LI4D
				real fp = st_kprimes[0][kp_idx_0] * P * p +
							st_kprimes[0][kp_idx_1] * P * q +
							st_kprimes[1][kp_idx_2] * P * r +
							st_kprimes[1][kp_idx_3] * P * s +
							st_kprimes[2][kp_idx_4] * Q * p +
							st_kprimes[2][kp_idx_5] * Q * q +
							st_kprimes[3][kp_idx_6] * Q * r +
							st_kprimes[3][kp_idx_7] * Q * s +
							st_kprimes[4][kp_idx_8] * R * p +
							st_kprimes[4][kp_idx_9] * R * q +
							st_kprimes[5][kp_idx_10] * R * r +
							st_kprimes[5][kp_idx_11] * R * s +
							st_kprimes[6][kp_idx_12] * S * p +
							st_kprimes[6][kp_idx_13] * S * q +
							st_kprimes[7][kp_idx_14] * S * r +
							st_kprimes[7][kp_idx_15] * S * s;
				#if AST_UNROLL && ACCEL
				for (int k = 0; k < NUM_KCROSS; ++k) {
					kprime_interp0[k][kpi_idx] = fp;
					kprime_interp1[k][kpi_idx] = fp;
				}
				#else
				kprime_interp0[kpi_idx] = fp;
				kprime_interp1[kpi_idx] = fp;
				#endif
				++kpi_idx;
			}
		}

		#if AST_UNROLL && ACCEL
		small_idx_t kidx = 0;
		// Loop 1.3: AST agents interp over kprime_interp
		// Unroll factor dictated by inner loop over k
		for (int j = 0; j < (N_AGENTS / IDS_PACK_FACTOR) / IDS_AGG_X; ++j) {
			#pragma HLS pipeline
			curr_ids = idshock[idshock_idx++];

			// for (int k = 0; k < IDS_PACK_FACTOR; ++k)
			// 	#pragma HLS unroll
			// 	p1b[k] = st_kcross[k][kidx];
			// hw_fr_n100_8(i2b, p1b, st_env.k[0]);

			for (int k = 0; k < IDS_PACK_FACTOR * IDS_AGG_X; ++k) {
				real p1b = st_kcross[k][kidx];
				range_t i2b = hw_findrange(st_kcross[k][kidx], st_env.k_egm, NKGRID);
				#ifdef __SYNTHESIS__
				real p0b = curr_ids.get_bit(k) ? (real)1.0 : (real)0.0;
				#else
				real p0b = (curr_ids & 0b1) ? (real)1.0 : (real)0.0;
				curr_ids >>= 1; 
				#endif

				// if (global_debug < 32) {
				// 	printf("[%d]: %g\n", global_debug, p0b);
				// 	global_debug++;
				// }
				// if (!global_debug)
				// 	fprintf(stderr, "%d\n", (int) p0b);

				range_t i1b = hw_findrange(p0b, st_env.epsilon2[k], NSTATES_ID);
				small_idx_t i1b_min_base = NKGRID * i1b.min;
				small_idx_t i1b_max_base = NKGRID * i1b.max;
				real bz = (p0b - i1b.min_val) / (i1b.max_val - i1b.min_val);
				real bw = (p1b - i2b.min_val) / (i2b.max_val - i2b.min_val);
				kc_t fpb = kprime_interp0[k][i1b_min_base + i2b.min]
						* ((real)1.0 - bz) * ((real)1.0 - bw) +
					   kprime_interp0[k][i1b_min_base + i2b.max]
						* ((real)1.0 - bz) *              bw  +
					   kprime_interp1[k][i1b_max_base + i2b.min]
						*              bz  * ((real)1.0 - bw) +
					   kprime_interp1[k][i1b_max_base + i2b.max]
						*              bz  *              bw;
				hw_rail_values(&fpb, KMAX, KMIN);
				st_kcross[k][kidx] = fpb;
				curr_sum += fpb;
				kidx++;
				#if OUT_DEBUG_DATA
				curr_sum_cnt++;
				#endif
			}
		}



		#else
		small_idx_t ids_phase = IDS_PACK_FACTOR;
		// Loop 1.3: AST agents interp over kprime_interp
		for (int j = 0; j < N_AGENTS; ++j) {
			#pragma HLS pipeline
			// Read next packed idshock value when needed
			if (++ids_phase >= IDS_PACK_FACTOR) {
				curr_ids = idshock[idshock_idx++];
				ids_phase = 0;
			}
			// HW_LI_2D_BASE:
			#ifdef __SYNTHESIS__
			real p0b = curr_ids.get_bit(ids_phase) ? (real)1.0 : (real)0.0; 
			#else
			real p0b = (curr_ids & 0b1) ? (real)1.0 : (real)0.0;
			curr_ids >>= 1; 
			#endif

			real p1b = st_kcross[j];
			range_t i1b = hw_findrange(p0b, st_env.epsilon2, NSTATES_ID);
			range_t i2b = hw_findrange(p1b, st_env.k_egm, NKGRID);
			// quick can *128 and -28
			small_idx_t i1b_min_base = NKGRID * i1b.min; // always 0
			small_idx_t i1b_max_base = NKGRID * i1b.max; // always NKGRID
			real bz = (p0b - i1b.min_val) / (i1b.max_val - i1b.min_val);
			real bw = (p1b - i2b.min_val) / (i2b.max_val - i2b.min_val);
			/** Produces [1100 * 10,000]
			 * technically can replace i1b_min/max_base with 0 and NKGRID
			 * bz
			 * bw
			 */

			// real fv0 = kprime_interp0[i1b_min_base + i2b.min];
			// real fv1 = kprime_interp0[i1b_min_base + i2b.max];
			// real fv2 = kprime_interp1[i1b_max_base + i2b.min];
			// real fv3 = kprime_interp1[i1b_max_base + i2b.max];

			kc_t fpb = kprime_interp0[i1b_min_base + i2b.min]
						* ((real)1.0 - bz) * ((real)1.0 - bw) +
					   kprime_interp0[i1b_min_base + i2b.max]
						* ((real)1.0 - bz) *              bw  +
					   kprime_interp1[i1b_max_base + i2b.min]
						*              bz  * ((real)1.0 - bw) +
					   kprime_interp1[i1b_max_base + i2b.max]
						*              bz  *              bw;

			hw_rail_values(&fpb, KMAX, KMIN);
			st_kcross[j] = fpb;
			curr_sum += fpb;
		#if OUT_DEBUG_DATA
			curr_sum_cnt++;
		#endif
		}
		#endif
		// Update kmts for next iteration
		curr_kmts = (real) curr_sum * N_AGENTS_INV;
		hw_rail_values(&curr_kmts, KM_MAX, KM_MIN);
	} // end simulation steps
	st_kmts_init = curr_kmts;
	#if OUT_DEBUG_DATA
	*asts = curr_sum_cnt;
	#endif


	global_debug = 1;
	return;
}


void hw_init_env()
{
	#pragma HLS inline
	#pragma HLS array_partition variable=st_env.P complete
	#if AST_UNROLL && ACCEL
	#pragma HLS array_partition variable=st_env.epsilon2 complete dim=1
	#endif
	st_env.beta = 0.99;
	st_env.alpha = 0.36;
	st_env.delta = 0.025;
	st_env.delta_a = 0.01;
	st_env.mu = 0.15;
	st_env.l_bar = 1 / 0.9;

	st_env.l_bar_inv = 0.9;
	st_env.gamma_inv = 1;
	st_env.gamma_neg = -1;
	st_env.gamma_neg_inv = -1;

	st_env.epsilon_u = 0;
	st_env.epsilon_e = 1;

	st_env.ur[0] = 0.1;
	st_env.er[0] = (1 - st_env.ur[0]);
	st_env.ur[1] = 0.04;
	st_env.er[1] = (1 - st_env.ur[1]);

	st_env.er_inv[0] = 1/st_env.er[0];
	st_env.er_inv[1] = 1/st_env.er[1];

	// should be able to re-use?
	// st_env.kss = hw_pow((1./st_env.beta-(1.-st_env.delta))/st_env.alpha,1./(st_env.alpha-1));
	st_env.kss = env__kss;

	// transition
	st_env.P[0] = 0.525;
	st_env.P[1] = 0.35;
	st_env.P[2] = 0.03125;
	st_env.P[3] = 0.09375;
	st_env.P[4] = 0.038889;
	st_env.P[5] = 0.836111;
	st_env.P[6] = 0.002083;
	st_env.P[7] = 0.122917;
	st_env.P[8] = 0.09375;
	st_env.P[9] = 0.03125;
	st_env.P[10] = 0.291667;
	st_env.P[11] = 0.583333;
	st_env.P[12] = 0.009115;
	st_env.P[13] = 0.115885;
	st_env.P[14] = 0.024306;
	st_env.P[15] = 0.850694;

	// parmshocks
	st_env.epsilon[0] = st_env.epsilon_u;
	st_env.epsilon[1] = st_env.epsilon_e;
	#if AST_UNROLL && ACCEL
	for (int k = 0; k < NUM_KCROSS; ++k) {
		st_env.epsilon2[k][0] = 0;
		st_env.epsilon2[k][1] = 1;
	}
	#else
	st_env.epsilon2[0] = 0;
	st_env.epsilon2[1] = 1;
	#endif

	st_env.ag[0] = 1 - st_env.delta_a;
	st_env.ag[1] = 1 + st_env.delta_a;
	st_env.ag2[0] = 0;
	st_env.ag2[1] = 1;
	return;
}

void force_init_env(void)
{
	#pragma HLS inline
	#if AST_UNROLL && ACCEL
	#pragma HLS array_partition variable=st_env.k complete dim=1
	#endif
	real val;
	hw_init_env();
	for (int i = 0; i < NKM_GRID; ++i) {
		// #pragma HLS unroll
		val = km_grid[i];
		st_env.km[i] = val;
		st_env.km_egm[i] = val;
	}
	for (int i = 0; i < NKGRID; ++i) {
		// #pragma HLS unroll factor=2
		val = k_grid[i];
		st_env.k_egm[i] = val;
	#if AST_UNROLL && ACCEL
		for (int k = 0; k < NUM_KCROSS; ++k)
			st_env.k[k][i] = val;
	#else
		st_env.k[i] = val;
	#endif
		
	}

	for (int i = 0; i < NSTATES; ++i)
		st_env.wealth[i] = init_wealth[i];

	st_env.irate_factor[0] = 0.356400012969971;
	st_env.irate_factor[1] = 0.363600015640259;

	st_env.wage_factor[0] = 0.633599991941452;
	st_env.wage_factor[1] = 0.646399979448319;

	st_env.cons2_factor[0] = 0.150000005960464;
	st_env.cons2_factor[1] = 1.094444491830137;
	st_env.cons2_factor[2] = 0.150000005960464;
	st_env.cons2_factor[3] = 1.104861160442233;

	st_env.log_env_km[0] = 3.401197433471680;
	st_env.log_env_km[1] = 3.601868152618408;
	st_env.log_env_km[2] = 3.768922090530396;
	st_env.log_env_km[3] = 3.912023067474365;
	return;
}
